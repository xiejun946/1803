nginxæ”¯æŒmmapï¼Œå†…å­˜æ‹·è´ï¼Œåˆ©ç”¨mmapåŠ é€Ÿäºå†…æ ¸çš„æ¶ˆæ¯ä¼ é€’ï¼Œå³åˆ©ç”¨epolå‡å°‘å¤åˆ¶çš„å¤åˆ¶æ¶ˆè€—
sendfile on; è°ƒç”¨åœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ç›´æ¥ä¼ é€’æ•°æ®(å®Œå…¨åœ¨å†…æ ¸ä¸­æ“ä½œ)ï¼Œä»è€Œé¿å…äº†æ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç”¨æˆ·ç¼“å†²åŒºä¹‹é—´çš„æ‹·è´ï¼Œæ“ä½œæ•ˆç‡å¾ˆé«˜ï¼Œè¢«ç§°ä¹‹ä¸ºé›¶æ‹·è´ï¼Œlinuxæ˜¯é€šè¿‡æ–‡ä»¶æè¿°ç¬¦æ¥å­˜å‚¨æ–‡ä»¶çš„ï¼Œå¼€å¯sendfileè·³è¿‡ç¡¬ç›˜ç¼“å†²åŒºç›´æ¥æ‹·è´
fastcgi_cache TEST;  å¼€å¯ FastCGI ç¼“å­˜å¹¶ä¸”ä¸ºå…¶åˆ¶å®šä¸€ä¸ªåç§°ã€‚ä¸ªäººæ„Ÿè§‰å¼€å¯ç¼“å­˜éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½CPU è´Ÿè½½ï¼Œå¹¶ä¸”é˜²æ­¢ 502 é”™è¯¯ã€‚
epolï¼Œå†³å®šnginxæ¯”apacheé«˜è´Ÿè½½é‡çš„å…³é”®å°±æ˜¯epolå¤šè·¯å¤ç”¨IOæ¨¡å‹
events
{
use epoll;
worker_connections 204800;
}
ä¸‹é¢æ˜¯ç®€å•nginxé…ç½®
user www www;
worker_processes 8;
worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 
01000000;
error_log /www/log/nginx_error.log crit;
pid /usr/local/nginx/nginx.pid;
worker_rlimit_nofile 204800;
events
{
use epoll;
worker_connections 204800;
}
http
{
include mime.types;
default_type application/octet-stream;
charset utf-8;
server_names_hash_bucket_size 128;
client_header_buffer_size 2k;
large_client_header_buffers 4 4k;
client_max_body_size 8m;
tcp_nopush on;
keepalive_timeout 60;
fastcgi_cache_path /usr/local/nginx/fastcgi_cache levels=1:2
keys_zone=TEST:10m
inactive=5m;
fastcgi_connect_timeout 300;
fastcgi_send_timeout 300;
fastcgi_read_timeout 300;
fastcgi_buffer_size 4k;
fastcgi_buffers 8 4k;
fastcgi_busy_buffers_size 8k;
fastcgi_temp_file_write_size 8k;
sendfile on; è°ƒç”¨åœ¨ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ä¹‹é—´ç›´æ¥ä¼ é€’æ•°æ®(å®Œå…¨åœ¨å†…æ ¸ä¸­æ“ä½œ)ï¼Œä»è€Œé¿å…äº†æ•°æ®åœ¨å†…æ ¸ç¼“å†²åŒºå’Œç”¨æˆ·ç¼“å†²åŒºä¹‹é—´çš„æ‹·è´ï¼Œæ“ä½œæ•ˆç‡å¾ˆé«˜ï¼Œè¢«ç§°ä¹‹ä¸ºé›¶æ‹·è´
fastcgi_cache TEST;  å¼€å¯ FastCGI ç¼“å­˜å¹¶ä¸”ä¸ºå…¶åˆ¶å®šä¸€ä¸ªåç§°ã€‚ä¸ªäººæ„Ÿè§‰å¼€å¯ç¼“å­˜éå¸¸æœ‰ç”¨ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½CPU è´Ÿè½½ï¼Œå¹¶ä¸”é˜²æ­¢ 502 é”™è¯¯ã€‚
server_tokens off; å…³é—­è¯·æ±‚å¤´ä¸­nginxç‰ˆæœ¬å·æ˜¾ç¤º
fastcgi_cache_valid 200 302 1h;
fastcgi_cache_valid 301 1d; 
fastcgi_cache_valid any 1m;
fastcgi_cache_min_uses 1;
fastcgi_cache_use_stale error timeout invalid_header http_500;
open_file_cache max=204800 inactive=20s;
open_file_cache_min_uses 1;
open_file_cache_valid 30s;
tcp_nodelay on;
gzip on;
gzip_min_length 1k;
gzip_buffers 4 16k;
gzip_http_version 1.0;
gzip_comp_level 2;
gzip_types text/plain application/x-javascript text/css application/xml;
gzip_vary on;
server
{
listen 8080;
server_name backup.aiju.com;
index index.php index.htm;= â‰¥Ã·  ğŸ˜ğŸ˜­
root /www/html/;
location /status
{
stub_status on;
}
location ~ .*\.(php|php5)?$
{
fastcgi_pass 127.0.0.1:9000;
fastcgi_index index.php;
include fcgi.conf;
}
